<html lang="en">
  <head>
    <title>lamina.stats documentation</title>
    <link href="css/default.css" type="text/css" rel="stylesheet" />
    <link href="css/codox-md.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/page_effects.js"></script>
  </head>
  <body>
    <header>
      <div id="header">
        <h1 class="project-title">Lamina 0.5.0-rc2 API documentation</h1>
      </div>
    </header>
    <navigation>
      <div id="namespaces" class="sidebar">
        <h3>Namespaces</h3>
        <ul class="ns-links">
          <li class="ns-list"><a class="ns-link ns-name" href="lamina.api.html">lamina.api</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.core.html">lamina.core</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.executor.html">lamina.executor</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.query.html">lamina.query</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.stats.html">lamina.stats</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.time.html">lamina.time</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.trace.html">lamina.trace</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.viz.html">lamina.viz</a></li><li class="ns-list"><a class="ns-link ns-name" href="lamina.walk.html">lamina.walk</a></li>
        </ul>
      </div>
      <div id="vars" class="sidebar">
        <h3>Public Vars</h3>
        <ul class="ns-var-links">
          <li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-moving-average">moving-average</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-moving-quantiles">moving-quantiles</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-moving-sample">moving-sample</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-outliers">outliers</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-quantiles">quantiles</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-rate">rate</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-sample">sample</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-sum">sum</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="lamina.stats.html#var-variance">variance</a></li>
        </ul>
      </div>
    </navigation>
    <article>
      <div id="content" class="namespace-docs">
        <h2 class="namespace-title">lamina.stats documentation</h2>
        <div class="doc">
</div>
        <div class="ns-vars">
          <div class="public">
            <h3><a id="var-moving-average" class="source var-name" href="/src/lamina/stats.clj">moving-average</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [period window task-queue], :or {window (t/minutes 5), period (t/period)}, :as options} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will periodically emit the moving average over all messages emitted by
the source channel every <code>period</code> milliseconds, defaulting to once every five seconds.  This
moving average is exponentially weighted to the last <code>window</code> milliseconds, defaulting to the
last five minutes.</p>
</div>
          </div><div class="public">
            <h3><a id="var-moving-quantiles" class="source var-name" href="/src/lamina/stats.clj">moving-quantiles</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [period window quantiles task-queue sample-size], :or {quantiles [0.5 0.75 0.95 0.99 0.999], task-queue (t/task-queue), window (t/minutes 5)}, :as options} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will periodically emit a map of quantile values every <code>period</code>
millseconds, which represent the statistical distribution of values emitted by the source
channel, weighted towards the last <code>window</code> milliseconds.</p>

<p>The map will be of quantile onto quantile value, so for a uniform distribution of values from
1..1000, it would emit</p>

<p>  {0.5 500, 0.75 750, 0.95 950, 0.99 990, 0.999 999}</p>

<p>By default, the above quantiles will be used, these can be specified as a sequence of quantiles
of the form [0.5 0.75 0.99 0.999].</p>
</div>
          </div><div class="public">
            <h3><a id="var-moving-sample" class="source var-name" href="/src/lamina/stats.clj">moving-sample</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [window period sample-size task-queue], :as options} ch]</div>
            
            
            <div class="doc"><p>Accumulates a representative sample of values passing through the channel, biased towards values within the
last <code>window</code> milliseconds.</p>

<p>The current sample is emitted every <code>period</code> milliseconds.</p>
</div>
          </div><div class="public">
            <h3><a id="var-outliers" class="source var-name" href="/src/lamina/stats.clj">outliers</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[facet ch]</div><div class="usage">[facet {:keys [window variance-predicate task-queue], :or {window (t/minutes 5), variance-predicate (fn* [p1__14628#] (&lt; 3 (abs (double p1__14628#)))), task-queue (t/task-queue)}} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will emit outliers from the source channel, as measured by the standard
deviations from the mean value of (facet msg).  Outlier status is determined by
'variance-predicate', which is given the standard deviations from the mean, and returns true
or false.  By default, it will return true for any value where the absolute value is greater
than three.</p>

<p>For instance, to monitor function calls that take an unusually long or short time via a
<code>return</code> probe:</p>

<p>  (outliers :duration (probe-channel :name:return))</p>

<p>To only receive outliers that are longer than the mean, define a custom :predicate</p>

<p>  (outliers
    :duration
    {:window (lamina.time/minutes 15)
     :variance-predicate #(&lt; % 3)}
    (probe-channel :name:return))</p>

<p>:window describes the window of the moving average, which defaults to five minutes.  This can
be used to adjust the responsiveness to long-term changes to the mean.</p>
</div>
          </div><div class="public">
            <h3><a id="var-quantiles" class="source var-name" href="/src/lamina/stats.clj">quantiles</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [period quantiles task-queue sample-size], :or {quantiles [0.5 0.75 0.95 0.99 0.999], task-queue (t/task-queue)}, :as options} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will periodically emit a map of quantile values every <code>period</code>
millseconds, which represent the statistical distribution of values emitted by the source
channel.</p>

<p>The map will be of quantile onto quantile value, so for a uniform distribution of values from
1..1000, it would emit</p>

<p>  {0.5 500, 0.75 750, 0.95 950, 0.99 990, 0.999 999}</p>

<p>By default, the above quantiles will be used, these can be specified as a sequence of quantiles
of the form [0.5 0.75 0.99 0.999].</p>
</div>
          </div><div class="public">
            <h3><a id="var-rate" class="source var-name" href="/src/lamina/stats.clj">rate</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [period task-queue], :as options} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will periodically emit the number of messages emitted by the source
channel over the last <code>period</code> milliseconds, with a default of 1000.</p>
</div>
          </div><div class="public">
            <h3><a id="var-sample" class="source var-name" href="/src/lamina/stats.clj">sample</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [window period sample-size task-queue], :as options} ch]</div>
            
            
            <div class="doc"><p>Accumulates a representative sample of values passing through the channel.</p>

<p>The current sample is emitted every <code>period</code> milliseconds.</p>
</div>
          </div><div class="public">
            <h3><a id="var-sum" class="source var-name" href="/src/lamina/stats.clj">sum</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [period task-queue], :as options} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will periodically emit the sum of all messages emitted by the source
channel over the last <code>period</code> milliseconds, with a default of 1000.</p>

<p>It is assumed that all numbers emitted by the source channel are integral values.</p>
</div>
          </div><div class="public">
            <h3><a id="var-variance" class="source var-name" href="/src/lamina/stats.clj">variance</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[ch]</div><div class="usage">[{:keys [period task-queue], :as options} ch]</div>
            
            
            <div class="doc"><p>Returns a channel that will periodically emit the variance of all values emitted by the source
channel every <code>period</code> milliseconds.</p>
</div>
          </div>
        </div>
      </div>
    </article>
  </body>

</html>